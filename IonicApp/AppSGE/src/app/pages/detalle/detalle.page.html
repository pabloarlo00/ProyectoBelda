<app-header></app-header>

<ion-content class="ion-padding">
  @if (noticia?.imagenes && noticia?.imagenes!.length > 0) {
  <swiper-container pagination="true" class="bg-dark mb-3">
    @for (foto of noticia?.imagenes; track $index) {
    <swiper-slide>
      <ion-img
        [src]="foto"
        class="vw-100 object-fit-cover"
        style="height: 250px"
      >
      </ion-img>
    </swiper-slide>
    }
  </swiper-container>
  }

  <h2 class="fw-bold">{{ noticia?.titulo }}</h2>
  <p class="text-muted">{{ noticia?.subtitulo }}</p>

  <ion-chip color="primary">
    <ion-icon [name]="noticia?.seccion?.iconoApp" ></ion-icon>
    <ion-label class="ms-2">{{ noticia?.seccion?.nombre }}</ion-label>
  </ion-chip>

  <div class="mt-2 mb-3">
    <ion-note color="medium">
      Por: <strong>{{ noticia?.autor }}</strong> | {{ noticia?.fecha |
      date:'dd/MM/yyyy' }}
    </ion-note>
  </div>

  <ion-accordion-group class="mt-3">
    <ion-accordion value="noticiaContenido">
      <ion-item slot="header" color="light">
        <ion-label>Contenido</ion-label>
      </ion-item>
      <div class="ion-padding" slot="content">{{ noticia?.contenido }}</div>
    </ion-accordion>
  </ion-accordion-group>

  <ion-list class="mt-4">
    <ion-list-header>
      <ion-label>Comentarios</ion-label>
      <ion-button id="open-modal" fill="clear" expand="block">
        Añadir
      </ion-button>
    </ion-list-header>

    @for (c of noticia?.comentarios; track $index) {
    <ion-item>
      <ion-avatar slot="start">
        <ion-icon name="person-circle-outline" size="large"></ion-icon>
      </ion-avatar>
      <ion-label>
        <h3>{{ c.nombre }}</h3>
        <h3>{{c.email}}</h3>
        <p>{{ c.comentario }}</p>
      </ion-label>
    </ion-item>
    }
  </ion-list>

<ion-modal trigger="open-modal" (willDismiss)="onWillDismiss($event)">
  <ng-template>
      <ion-header>
        <ion-toolbar color="primary">
          <ion-buttons slot="start">
            <ion-button (click)="cancelar()">CANCELAR</ion-button>
          </ion-buttons>
          <ion-title>Nuevo Comentario</ion-title>
          <ion-buttons slot="end">
            <ion-button (click)="confirmar()" [strong]="true">CONFIRMAR</ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>

      <ion-content class="ion-padding">
        <ion-item>
          <ion-input
            [(ngModel)]="nuevoComentario.nombre"
            name="nombre"
            type="text"
            label="Nombre"
            labelPlacement="stacked"
            pattern=""
            placeholder="Mínimo 3 caracteres"
            required
          ></ion-input>
        </ion-item>

        <ion-item>
          <ion-input
            [(ngModel)]="nuevoComentario.email"
            name="email"
            type="email"
            label="Email"
            labelPlacement="stacked"
            placeholder="ejemplo@correo.com"
            required
          ></ion-input>
        </ion-item>

        <ion-item>
          <ion-textarea
            [(ngModel)]="nuevoComentario.comentario"
            name="comentario"
            label="Comentario"
            labelPlacement="stacked"
            placeholder="Escribe aquí tu opinión (mín. 2 caracteres)"
            required
          ></ion-textarea>
        </ion-item>
      </ion-content>
  </ng-template>
</ion-modal>
</ion-content>
